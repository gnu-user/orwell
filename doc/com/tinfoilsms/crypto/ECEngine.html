<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_11) on Thu Jan 24 00:15:16 EST 2013 -->
<title>ECEngine</title>
<meta name="date" content="2013-01-24">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="ECEngine";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ECEngine.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/tinfoilsms/crypto/APrioriInfo.html" title="class in com.tinfoilsms.crypto"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../com/tinfoilsms/crypto/ECGKeyExchange.html" title="class in com.tinfoilsms.crypto"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/tinfoilsms/crypto/ECEngine.html" target="_top">Frames</a></li>
<li><a href="ECEngine.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.tinfoilsms.crypto</div>
<h2 title="Class ECEngine" class="title">Class ECEngine</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>com.tinfoilsms.crypto.ECEngine</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">ECEngine</span>
extends java.lang.Object</pre>
<div class="block">A wrapper class that simplifies the creation of the IESEngine and all of
 the parameters needed for using the IESEngine such as the block cipher mode,
 block cipher engine, ECDH key exchange protocol, key derivative function (KDF),
 and HMAC.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><strong><a href="../../../com/tinfoilsms/crypto/ECEngine.html#BLOCKSIZE">BLOCKSIZE</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private org.spongycastle.crypto.BufferedBlockCipher</code></td>
<td class="colLast"><code><strong><a href="../../../com/tinfoilsms/crypto/ECEngine.html#cipher">cipher</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><strong><a href="../../../com/tinfoilsms/crypto/ECEngine.html#CIPHERKEYSIZE">CIPHERKEYSIZE</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private org.spongycastle.crypto.engines.IESEngine</code></td>
<td class="colLast"><code><strong><a href="../../../com/tinfoilsms/crypto/ECEngine.html#engine">engine</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private org.spongycastle.crypto.params.IESParameters</code></td>
<td class="colLast"><code><strong><a href="../../../com/tinfoilsms/crypto/ECEngine.html#param">param</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../com/tinfoilsms/crypto/ECEngine.html#ECEngine(com.tinfoilsms.crypto.APrioriInfo)">ECEngine</a></strong>(<a href="../../../com/tinfoilsms/crypto/APrioriInfo.html" title="class in com.tinfoilsms.crypto">APrioriInfo</a>&nbsp;sharedInfo)</code>
<div class="block">The default constructor, creates an instance of the ECEngine using the
 following default parameters, it is recommended that you use this
 constructor unless you have a pressing need to deviate from the default
 parameters.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><strong><a href="../../../com/tinfoilsms/crypto/ECEngine.html#ECEngine(org.spongycastle.crypto.BufferedBlockCipher, com.tinfoilsms.crypto.APrioriInfo)">ECEngine</a></strong>(org.spongycastle.crypto.BufferedBlockCipher&nbsp;cipher,
        <a href="../../../com/tinfoilsms/crypto/APrioriInfo.html" title="class in com.tinfoilsms.crypto">APrioriInfo</a>&nbsp;sharedInfo)</code>
<div class="block">Constructor, specify the block cipher to use such as CBC or BlowFish.</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../com/tinfoilsms/crypto/ECEngine.html#ECEngine(org.spongycastle.crypto.BufferedBlockCipher, org.spongycastle.crypto.Digest, com.tinfoilsms.crypto.APrioriInfo)">ECEngine</a></strong>(org.spongycastle.crypto.BufferedBlockCipher&nbsp;cipher,
        org.spongycastle.crypto.Digest&nbsp;digest,
        <a href="../../../com/tinfoilsms/crypto/APrioriInfo.html" title="class in com.tinfoilsms.crypto">APrioriInfo</a>&nbsp;sharedInfo)</code>
<div class="block">Constructor, specify the block cipher and digest to use</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><strong><a href="../../../com/tinfoilsms/crypto/ECEngine.html#ECEngine(org.spongycastle.crypto.Digest, com.tinfoilsms.crypto.APrioriInfo)">ECEngine</a></strong>(org.spongycastle.crypto.Digest&nbsp;digest,
        <a href="../../../com/tinfoilsms/crypto/APrioriInfo.html" title="class in com.tinfoilsms.crypto">APrioriInfo</a>&nbsp;sharedInfo)</code>
<div class="block">Constructor, specify the digest to use such as such as SHA256/MD5</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/tinfoilsms/crypto/ECEngine.html#init(boolean, org.spongycastle.crypto.CipherParameters, org.spongycastle.crypto.CipherParameters)">init</a></strong>(boolean&nbsp;forEncrypt,
    org.spongycastle.crypto.CipherParameters&nbsp;priKey,
    org.spongycastle.crypto.CipherParameters&nbsp;pubKey)</code>
<div class="block">A wrapper for IESEngine, initializes the elliptic curve encryption engine
 in either encryption or decryption mode.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../com/tinfoilsms/crypto/ECEngine.html#processBlock(byte[])">processBlock</a></strong>(byte[]&nbsp;in)</code>
<div class="block">A wrapper for IESEngine processBlock() method, receives user input and
 encrypts or decrypts the input received.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../com/tinfoilsms/crypto/ECEngine.html#processBlock(byte[], int, int)">processBlock</a></strong>(byte[]&nbsp;in,
            int&nbsp;inOff,
            int&nbsp;inLen)</code>
<div class="block">A wrapper for IESEngine processBlock() method, receives user input and
 encrypts or decrypts the input received.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="BLOCKSIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>BLOCKSIZE</h4>
<pre>private static final&nbsp;int BLOCKSIZE</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../constant-values.html#com.tinfoilsms.crypto.ECEngine.BLOCKSIZE">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="CIPHERKEYSIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CIPHERKEYSIZE</h4>
<pre>private static final&nbsp;int CIPHERKEYSIZE</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../constant-values.html#com.tinfoilsms.crypto.ECEngine.CIPHERKEYSIZE">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="engine">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engine</h4>
<pre>private&nbsp;org.spongycastle.crypto.engines.IESEngine engine</pre>
</li>
</ul>
<a name="cipher">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cipher</h4>
<pre>private&nbsp;org.spongycastle.crypto.BufferedBlockCipher cipher</pre>
</li>
</ul>
<a name="param">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>param</h4>
<pre>private&nbsp;org.spongycastle.crypto.params.IESParameters param</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="ECEngine(com.tinfoilsms.crypto.APrioriInfo)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ECEngine</h4>
<pre>public&nbsp;ECEngine(<a href="../../../com/tinfoilsms/crypto/APrioriInfo.html" title="class in com.tinfoilsms.crypto">APrioriInfo</a>&nbsp;sharedInfo)</pre>
<div class="block">The default constructor, creates an instance of the ECEngine using the
 following default parameters, it is recommended that you use this
 constructor unless you have a pressing need to deviate from the default
 parameters.
 
 ECEngine is created using the following default parameters:
  - OFBBlockCipher mode using AESEngine with 128-bit block size
  - ECDHCBasicAgreement key agreement
  - KDF2BytesGenerator Key derivative function
  - SHA256 Digest/HMAC</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>sharedInfo</code> - the shared information exchanged by users a priori
 
 TODO: For OFB and CTR, reusing an IV completely destroys security, look into
 the security vulnerabilities that exist in using OFB, verify if possible how
 the IV is handled by IESEngine, may have to use CBC or find a way to specify
 unique IV!</dd></dl>
</li>
</ul>
<a name="ECEngine(org.spongycastle.crypto.BufferedBlockCipher, com.tinfoilsms.crypto.APrioriInfo)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ECEngine</h4>
<pre>public&nbsp;ECEngine(org.spongycastle.crypto.BufferedBlockCipher&nbsp;cipher,
        <a href="../../../com/tinfoilsms/crypto/APrioriInfo.html" title="class in com.tinfoilsms.crypto">APrioriInfo</a>&nbsp;sharedInfo)</pre>
<div class="block">Constructor, specify the block cipher to use such as CBC or BlowFish.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>cipher</code> - The buffered block cipher to use such as CBC or BlowFish</dd><dd><code>sharedInfo</code> - the shared information exchanged by users a priori
 
 TODO: Not sure whether to have it to just take a cipher that implements
 BlockCipher interface and instantiate the BufferedBlockCipher or to allow
 it to take the BufferedBlockCipher and simply use that... BufferedBlockCipher
 has multiple subclasses which could be used such as CTSBlockCipher</dd></dl>
</li>
</ul>
<a name="ECEngine(org.spongycastle.crypto.Digest, com.tinfoilsms.crypto.APrioriInfo)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ECEngine</h4>
<pre>public&nbsp;ECEngine(org.spongycastle.crypto.Digest&nbsp;digest,
        <a href="../../../com/tinfoilsms/crypto/APrioriInfo.html" title="class in com.tinfoilsms.crypto">APrioriInfo</a>&nbsp;sharedInfo)</pre>
<div class="block">Constructor, specify the digest to use such as such as SHA256/MD5</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>digest</code> - The digest to use for KDF/HMAC such as SHA256/MD5</dd><dd><code>sharedInfo</code> - the shared information exchanged by users a priori</dd></dl>
</li>
</ul>
<a name="ECEngine(org.spongycastle.crypto.BufferedBlockCipher, org.spongycastle.crypto.Digest, com.tinfoilsms.crypto.APrioriInfo)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ECEngine</h4>
<pre>public&nbsp;ECEngine(org.spongycastle.crypto.BufferedBlockCipher&nbsp;cipher,
        org.spongycastle.crypto.Digest&nbsp;digest,
        <a href="../../../com/tinfoilsms/crypto/APrioriInfo.html" title="class in com.tinfoilsms.crypto">APrioriInfo</a>&nbsp;sharedInfo)</pre>
<div class="block">Constructor, specify the block cipher and digest to use</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>cipher</code> - The buffered block cipher to use such as CBC or BlowFish</dd><dd><code>digest</code> - The digest to use for KDF/HMAC such as SHA256/MD5</dd><dd><code>sharedInfo</code> - the shared information exchanged by users a priori</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="init(boolean, org.spongycastle.crypto.CipherParameters, org.spongycastle.crypto.CipherParameters)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>init</h4>
<pre>public&nbsp;void&nbsp;init(boolean&nbsp;forEncrypt,
        org.spongycastle.crypto.CipherParameters&nbsp;priKey,
        org.spongycastle.crypto.CipherParameters&nbsp;pubKey)</pre>
<div class="block">A wrapper for IESEngine, initializes the elliptic curve encryption engine
 in either encryption or decryption mode.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>forEncrypt</code> - Engine mode, true for encryption, false for decryption</dd><dd><code>priKey</code> - Your private key parameters</dd><dd><code>pubKey</code> - The recipient's public key parameters</dd></dl>
</li>
</ul>
<a name="processBlock(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>processBlock</h4>
<pre>public&nbsp;byte[]&nbsp;processBlock(byte[]&nbsp;in)
                    throws org.spongycastle.crypto.InvalidCipherTextException</pre>
<div class="block">A wrapper for IESEngine processBlock() method, receives user input and
 encrypts or decrypts the input received.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>in</code> - The input to encrypt or decrypt</dd>
<dt><span class="strong">Returns:</span></dt><dd>A byte array containing the contents of the encrypted/decrypted data</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.spongycastle.crypto.InvalidCipherTextException</code> - if the encryption/decryption fails or if 
 the HMAC is invalid (possible data corruption or tampering)</dd></dl>
</li>
</ul>
<a name="processBlock(byte[], int, int)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>processBlock</h4>
<pre>public&nbsp;byte[]&nbsp;processBlock(byte[]&nbsp;in,
                  int&nbsp;inOff,
                  int&nbsp;inLen)
                    throws org.spongycastle.crypto.InvalidCipherTextException</pre>
<div class="block">A wrapper for IESEngine processBlock() method, receives user input and
 encrypts or decrypts the input received.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>in</code> - The input to encrypt or decrypt</dd><dd><code>inOff</code> - The offset in the input to encrypt/decrypt</dd><dd><code>inLen</code> - The length of the input to encyrpt/decrypt</dd>
<dt><span class="strong">Returns:</span></dt><dd>A byte array containing the contents of the encrypted/decrypted data</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.spongycastle.crypto.InvalidCipherTextException</code> - if the encryption/decryption fails or if 
 the HMAC is invalid (possible data corruption or tampering)</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ECEngine.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/tinfoilsms/crypto/APrioriInfo.html" title="class in com.tinfoilsms.crypto"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../com/tinfoilsms/crypto/ECGKeyExchange.html" title="class in com.tinfoilsms.crypto"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/tinfoilsms/crypto/ECEngine.html" target="_top">Frames</a></li>
<li><a href="ECEngine.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>

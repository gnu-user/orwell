<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_17) on Mon May 06 00:15:47 EDT 2013 -->
<title>Nonce</title>
<meta name="date" content="2013-05-06">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Nonce";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Nonce.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/spongycastle/crypto/params/NaccacheSternPrivateKeyParameters.html" title="class in org.spongycastle.crypto.params"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/spongycastle/crypto/params/NTRUEncryptionKeyGenerationParameters.html" title="class in org.spongycastle.crypto.params"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/spongycastle/crypto/params/Nonce.html" target="_top">Frames</a></li>
<li><a href="Nonce.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.spongycastle.crypto.params</div>
<h2 title="Class Nonce" class="title">Class Nonce</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.spongycastle.crypto.params.Nonce</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../org/spongycastle/crypto/CipherParameters.html" title="interface in org.spongycastle.crypto">CipherParameters</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">Nonce</span>
extends java.lang.Object
implements <a href="../../../../org/spongycastle/crypto/CipherParameters.html" title="interface in org.spongycastle.crypto">CipherParameters</a></pre>
<div class="block">Provides support for generating numbers used once (nonce) which can be used as
 IVs for block cipher modes of operation such as CBC or CTR. The class uses a
 deterministic CSPRNG such as ISAAC to generate pseudo-random nonces which can
 then be used as IVs.
 
 This class functions as an external iterator generating a unique nonce each
 time the next operation is performed. Additionally, this class can also be
 initialized to any prior state given that the deterministic CSPRNG is provided
 with the same seed value it had prior and the IV of the last state.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../com/tinfoilsms/csprng/ISAACRandomGenerator.html" title="class in com.tinfoilsms.csprng">ISAACRandomGenerator</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/spongycastle/crypto/params/Nonce.html#csprng">csprng</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../org/spongycastle/crypto/params/Nonce.html#cycle">cycle</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><strong><a href="../../../../org/spongycastle/crypto/params/Nonce.html#MAXCYCLES">MAXCYCLES</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../org/spongycastle/crypto/params/Nonce.html#nonce">nonce</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../org/spongycastle/crypto/params/Nonce.html#Nonce(org.spongycastle.crypto.prng.RandomGenerator)">Nonce</a></strong>(<a href="../../../../org/spongycastle/crypto/prng/RandomGenerator.html" title="interface in org.spongycastle.crypto.prng">RandomGenerator</a>&nbsp;csprng)</code>
<div class="block">Construct the nonce with a deterministic CSPRNG, at the moment only ISAAC
 engine is supported, but in the future other CSPRNG such as ISAAC+ will 
 also be supported.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><strong><a href="../../../../org/spongycastle/crypto/params/Nonce.html#Nonce(org.spongycastle.crypto.prng.RandomGenerator, int)">Nonce</a></strong>(<a href="../../../../org/spongycastle/crypto/prng/RandomGenerator.html" title="interface in org.spongycastle.crypto.prng">RandomGenerator</a>&nbsp;csprng,
     int&nbsp;lastCycle)</code>
<div class="block">Construct the nonce with a deterministic CSPRNG, at the moment only ISAAC
 engine is supported, but in the future other CSPRNG such as ISAAC+ will 
 also be supported.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../../org/spongycastle/crypto/params/Nonce.html#getCycle()">getCycle</a></strong>()</code>
<div class="block">Get the current cycle, this is the number of nonces that have been
 generated.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../org/spongycastle/crypto/params/Nonce.html#getNonce()">getNonce</a></strong>()</code>
<div class="block">Accesses the current nonce, you should always execute the nextNonce()
 method before accessing a nonce to ensure that a unique nonce has been
 generated.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/spongycastle/crypto/params/Nonce.html#init(byte[], int)">init</a></strong>(byte[]&nbsp;seed,
    int&nbsp;nonceLen)</code>
<div class="block">Initialize the CSPRNG used by the nonce with the seed value provided so
 that it is deterministic in generating random data.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../org/spongycastle/crypto/params/Nonce.html#nextNonce()">nextNonce</a></strong>()</code>
<div class="block">Generates the next nonce and returns it</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/spongycastle/crypto/params/Nonce.html#reSeed(byte[])">reSeed</a></strong>(byte[]&nbsp;seed)</code>
<div class="block">Re-seeds the CSPRNG with the seed value specified, if your are using
 this Nonce in a cryptographic system with more than one user/system 
 all systems must re-seed at the same state with the same seed value
 in order to have the same sequence of nonces.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/spongycastle/crypto/params/Nonce.html#reset()">reset</a></strong>()</code>
<div class="block">Resets the CSPRNG used by the None, after resetting the CSPRNG you must 
 either re-initialize or re-seed it.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="csprng">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>csprng</h4>
<pre>private&nbsp;<a href="../../../../com/tinfoilsms/csprng/ISAACRandomGenerator.html" title="class in com.tinfoilsms.csprng">ISAACRandomGenerator</a> csprng</pre>
</li>
</ul>
<a name="nonce">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nonce</h4>
<pre>private&nbsp;byte[] nonce</pre>
</li>
</ul>
<a name="MAXCYCLES">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MAXCYCLES</h4>
<pre>private static final&nbsp;int MAXCYCLES</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../constant-values.html#org.spongycastle.crypto.params.Nonce.MAXCYCLES">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="cycle">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>cycle</h4>
<pre>private&nbsp;int cycle</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="Nonce(org.spongycastle.crypto.prng.RandomGenerator)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>Nonce</h4>
<pre>public&nbsp;Nonce(<a href="../../../../org/spongycastle/crypto/prng/RandomGenerator.html" title="interface in org.spongycastle.crypto.prng">RandomGenerator</a>&nbsp;csprng)
      throws java.lang.IllegalArgumentException</pre>
<div class="block">Construct the nonce with a deterministic CSPRNG, at the moment only ISAAC
 engine is supported, but in the future other CSPRNG such as ISAAC+ will 
 also be supported.
 
 Note, as the CSPRNG is deterministic if you have already used the CSPRNG and
 initialized the Nonce object with the same seed value to generate nonces 
 previously, you must create this object using the last nonce state in order
 to prevent reusing nonces/IVs, which is a security vulnerability.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>csprng</code> - Deterministic CSPRNG, currently only ISAAC is supported</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if the CSPRNG is not ISAAC</dd></dl>
</li>
</ul>
<a name="Nonce(org.spongycastle.crypto.prng.RandomGenerator, int)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>Nonce</h4>
<pre>public&nbsp;Nonce(<a href="../../../../org/spongycastle/crypto/prng/RandomGenerator.html" title="interface in org.spongycastle.crypto.prng">RandomGenerator</a>&nbsp;csprng,
     int&nbsp;lastCycle)
      throws java.lang.IllegalArgumentException</pre>
<div class="block">Construct the nonce with a deterministic CSPRNG, at the moment only ISAAC
 engine is supported, but in the future other CSPRNG such as ISAAC+ will 
 also be supported.
 
 Note, as the CSPRNG is deterministic if you have already used the CSPRNG and
 initialized the Nonce object with the same seed value to generate nonces 
 previously, you must create this object using the last nonce state in order
 to prevent reusing nonces/IVs, which is a security vulnerability.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>csprng</code> - Deterministic CSPRNG, currently only ISAAC is supported</dd><dd><code>lastCycle</code> - The last cycle counter for the nonce generated during an previous
 state of the Nonce object given the current CSPRNG, providing the last cycle prevents
 security vulnerabilities of re-using nonce/IVs.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if the CSPRNG is not ISAAC</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="init(byte[], int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>init</h4>
<pre>public&nbsp;void&nbsp;init(byte[]&nbsp;seed,
        int&nbsp;nonceLen)
          throws <a href="../../../../org/spongycastle/crypto/MaxBytesExceededException.html" title="class in org.spongycastle.crypto">MaxBytesExceededException</a>,
                 <a href="../../../../org/spongycastle/crypto/DataLengthException.html" title="class in org.spongycastle.crypto">DataLengthException</a></pre>
<div class="block">Initialize the CSPRNG used by the nonce with the seed value provided so
 that it is deterministic in generating random data.
 
 Again, because the CSPRNG is deterministic if you have already used the 
 CSPRNG and initialized the Nonce object with the same seed value to 
 generate nonces previously, you must create this object using the last 
 nonce state in order to prevent reusing nonces/IVs, which is a security 
 vulnerability.
 
 Lastly, if you initialize this object with incorrect seed value needed
 to generate the last nonce state the CSPRNG will eventually exhaust
 generating random numbers when it reaches MAXCYCLES and throw an
 exception, this prevents having to deal with the halting problem, where
 the program will run indefinitely generating random data.
 
 You must execute nextNonce after initializing the object in order to
 generate a unique nonce value.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>seed</code> - The seed value for the CSPRNG, must be specified</dd><dd><code>nonceLen</code> - The default length of the nonce to generate, 0 to use
 the length of the prior nonce value. Must be specified if Nonce was 
 constructed without a prior nonce value.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/spongycastle/crypto/MaxBytesExceededException.html" title="class in org.spongycastle.crypto">MaxBytesExceededException</a></code> - If CSPRNG reaches MAXCYCLES trying to
 return to the initial Nonce state, usually when the seed data provided is
 different than the previous seed data used to generate the last nonce state</dd>
<dd><code><a href="../../../../org/spongycastle/crypto/DataLengthException.html" title="class in org.spongycastle.crypto">DataLengthException</a></code> - If the nonceLength was not provided and the object
 was not instantiated with the prior nonce value of the last state.</dd></dl>
</li>
</ul>
<a name="nextNonce()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nextNonce</h4>
<pre>public&nbsp;byte[]&nbsp;nextNonce()</pre>
<div class="block">Generates the next nonce and returns it</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The nonce</dd></dl>
</li>
</ul>
<a name="getNonce()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNonce</h4>
<pre>public&nbsp;byte[]&nbsp;getNonce()</pre>
<div class="block">Accesses the current nonce, you should always execute the nextNonce()
 method before accessing a nonce to ensure that a unique nonce has been
 generated.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The nonce</dd></dl>
</li>
</ul>
<a name="getCycle()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCycle</h4>
<pre>public&nbsp;int&nbsp;getCycle()</pre>
<div class="block">Get the current cycle, this is the number of nonces that have been
 generated. This method is used to store the state of the generator
 to prevent IVs from being regenerated.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The number of cycles, or nonces generated</dd></dl>
</li>
</ul>
<a name="reSeed(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>reSeed</h4>
<pre>public&nbsp;void&nbsp;reSeed(byte[]&nbsp;seed)</pre>
<div class="block">Re-seeds the CSPRNG with the seed value specified, if your are using
 this Nonce in a cryptographic system with more than one user/system 
 all systems must re-seed at the same state with the same seed value
 in order to have the same sequence of nonces. Furthermore, if you
 re-create this Nonce object, you must initialize the object with
 this seed value to return to this state!</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>seed</code> - The seed value for the CSPRNG, must be specified</dd></dl>
</li>
</ul>
<a name="reset()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>reset</h4>
<pre>public&nbsp;void&nbsp;reset()</pre>
<div class="block">Resets the CSPRNG used by the None, after resetting the CSPRNG you must 
 either re-initialize or re-seed it.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Nonce.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/spongycastle/crypto/params/NaccacheSternPrivateKeyParameters.html" title="class in org.spongycastle.crypto.params"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/spongycastle/crypto/params/NTRUEncryptionKeyGenerationParameters.html" title="class in org.spongycastle.crypto.params"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/spongycastle/crypto/params/Nonce.html" target="_top">Frames</a></li>
<li><a href="Nonce.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
